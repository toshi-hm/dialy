# 設計書修正チェックリスト

## 使い方
- [ ] チェックボックスにチェックを入れて進捗管理
- 優先度: 🔴 高 > 🟡 中 > 🟢 低

---

## 🔴 優先度: 高（即修正必須）

### ✅ タスク1: バージョン表記の修正

- [ ] **00_INDEX.md** を修正
  - 行60-66: 詳細バージョンをメジャーバージョンのみに変更
  - 例: `Next.js 16.1.5` → `Next.js 16`

- [ ] **02_ARCHITECTURE.md** を修正
  - 表1.1（行16-42）: 全技術スタックのバージョンをメジャーのみに
  - 修正例:
    ```markdown
    | Next.js | 16 | SSR/SSG、ルーティング |
    | React | 19 | UIコンポーネント |
    | TypeScript | 5 | 型安全性 |
    | Tailwind CSS | 4 | ユーティリティファーストCSS |
    ```

**確認ポイント**:
- パッチバージョン（例: 16.1.5）が残っていないか
- "x" 表記（例: 5.x）も削除されているか

---

### ✅ タスク2: 存在しないドキュメントへの参照削除

- [ ] **00_INDEX.md** を修正
  - 行27-42: 05_FEATURES.md、06_SECURITY.md、07_PERFORMANCE.mdへの参照を削除
  - 修正後の目次:
    ```markdown
    ## 目次

    1. [要件定義](./01_REQUIREMENTS.md)
    2. [システムアーキテクチャ](./02_ARCHITECTURE.md)
    3. [データモデル設計](./03_DATA_MODEL.md)
    4. [UI/UX設計](./04_UI_UX_DESIGN.md)
    ```

**確認ポイント**:
- セクション5, 6, 7への参照が完全に削除されているか
- 「ドキュメントの読み方」セクション（行80-88）も更新されているか

---

### ✅ タスク3: MVP版アーキテクチャの明確化

- [ ] **02_ARCHITECTURE.md** のセクション1.4を修正
  - 現状の曖昧な記述を削除
  - MVP版は完全クライアントサイドと明記
  - 修正案:
    ```markdown
    ### 1.4 MVP版の技術選定

    MVP版では開発速度を優先し、完全クライアントサイドで実装:

    **データ保存**:
    - LocalStorage（ブラウザ内完結、サーバー不要）

    **コンポーネント**:
    - Client Components（'use client' ディレクティブ使用）
    - Server Componentsは将来実装

    **状態管理**:
    - React Hooks（useState, useEffect）

    **非採用（将来実装）**:
    - Server Actions（Phase 2で導入）
    - Prisma（Phase 2で導入）
    - NextAuth.js（Phase 2で導入）
    ```

- [ ] **02_ARCHITECTURE.md** のデータフロー図（セクション5）を修正
  - Server Action呼び出しのフローを削除
  - Client側で完結するフローに修正

**確認ポイント**:
- Server Actionsへの言及が「将来実装」と明記されているか
- データフロー図がクライアントサイドのみになっているか

---

### ✅ タスク4: 保存UXの整理

- [ ] **01_REQUIREMENTS.md** のFR-02を修正（行42-46）
  - 現状:
    ```markdown
    - リアルタイムでの自動保存（下書き保存）
    - 明示的な「保存」ボタンで確定保存
    ```
  - 修正案:
    ```markdown
    - リアルタイムでの自動保存（入力停止後1秒）
    - 保存状態を視覚的にフィードバック（「保存しました」アイコン表示）
    - 明示的な保存ボタンは不要（自動保存で完結）
    ```

- [ ] **04_UI_UX_DESIGN.md** のセクション3.5を修正
  - SaveButtonコンポーネントの記述を削除
  - または、自動保存インジケーターに変更

**確認ポイント**:
- 「確定保存」「保存ボタン」への言及が削除されているか
- 自動保存のフィードバック方法が明記されているか

---

### ✅ タスク5: Dial UI設計の再検討

- [ ] **04_UI_UX_DESIGN.md** のセクション3.1を修正
  - Dialの操作方法を再定義
  - 修正案:
    ```markdown
    #### 操作方法

    **主要機能: カレンダーダイアログ**
    - Dialをクリック/タップでカレンダーを表示
    - カレンダーから過去の任意の日付を直接選択

    **補助機能: 前後移動ボタン**
    - 「◀ 前日」「翌日 ▶」ボタンで日付を移動
    - キーボード操作: 矢印キー（←→）で前後移動

    **Dialの視覚的役割**
    - 選択中の日付を表示（中央に日付）
    - クリックでカレンダー表示のトリガー
    - 回転アニメーションは装飾的要素として残す
    ```

- [ ] **04_UI_UX_DESIGN.md** のセクション4.1を修正
  - 「360度 = 30日」の記述を削除
  - カレンダーダイアログの詳細を追加

**確認ポイント**:
- Dialで過去5年分を選択できる実装可能な方法になっているか
- ユーザーが直感的に操作できる設計か

---

## 🟡 優先度: 中（リリース前に検討）

### ✅ タスク6: 認証の実装有無を明確化

- [ ] **01_REQUIREMENTS.md** のNFR-07を修正（行159-161）
  - 修正案:
    ```markdown
    #### NFR-07: 認証（MVP版では実装しない）
    - **MVP版**: 認証なし、LocalStorageでブラウザローカルに保存
    - **制約**: シングルブラウザ/デバイスのみ、データ同期なし
    - **将来版（Phase 2）**: NextAuth.js を使用してマルチユーザー対応
    ```

**確認ポイント**:
- MVP版で認証を実装しないことが明記されているか
- 制約事項が明確か

---

### ✅ タスク7: DateValueクラスの扱いを決定

以下のいずれかを選択:

**オプションA: 削除（推奨）**
- [ ] **03_DATA_MODEL.md** のセクション2.1を削除
- [ ] DiaryEntryで直接Date型を使用することを明記

**オプションB: 実際に使用**
- [ ] DiaryEntryクラスを修正してDateValueを使用
- [ ] コード例を更新

**確認ポイント**:
- DateValueクラスの扱いが一貫しているか

---

### ✅ タスク8: 同じ日付の日記の整合性チェック追加

- [ ] **03_DATA_MODEL.md** のセクション6.2を修正
  - LocalStorageDiaryRepository.save()にバリデーション追加
  - コード例:
    ```typescript
    async save(entry: DiaryEntry): Promise<void> {
      const storage = this.getStorage();

      // 同じ日付の別の日記が存在するかチェック
      const dateStr = entry.date.toISOString().split('T')[0];
      const existingIndex = storage.entries.findIndex(
        (e) => e.date === dateStr && e.id !== entry.id
      );

      if (existingIndex >= 0) {
        throw new Error('An entry for this date already exists');
      }

      // ... 以下、既存の保存処理
    }
    ```

**確認ポイント**:
- 同じ日付の重複保存を防ぐロジックが追加されているか

---

### ✅ タスク9: 過去の日記展開時のUX改善

- [ ] **04_UI_UX_DESIGN.md** のセクション3.4を修正
  - 展開方法を再検討
  - 修正案:
    ```markdown
    #### 展開方法

    **オプション1: モーダル表示（推奨）**
    - カードをクリックでモーダルウィンドウを表示
    - 編集エリアは影響を受けない
    - モーダル内で全文表示、スクロール可能

    **オプション2: 固定ヘッダー方式**
    - 編集エリアを画面上部に固定
    - 過去の日記リストのみスクロール
    ```

**確認ポイント**:
- レイアウトシフトが最小限になっているか

---

### ✅ タスク10: パフォーマンス目標の調整

- [ ] **01_REQUIREMENTS.md** のNFR-01を修正（行120-124）
  - 修正案:
    ```markdown
    #### NFR-01: ページ読み込み速度

    **MVP版（Phase 1）**:
    - 初回ページ読み込み: 3秒以内
    - Lighthouse Performance Score: 80以上

    **将来版（Phase 2）**:
    - Lighthouse Performance Score: 90以上
    - Core Web Vitals: すべて「Good」評価
    ```

**確認ポイント**:
- 段階的な目標設定になっているか
- 達成可能な数値か

---

## 🟢 優先度: 低（将来の改善）

### ✅ タスク11: Webフォントの検討

- [ ] **04_UI_UX_DESIGN.md** のセクション6.2を修正
  - Noto Sans JPを追加
  - 修正案:
    ```css
    font-family:
      'Noto Sans JP',
      'Hiragino Kaku Gothic ProN',
      'Yu Gothic',
      'Meiryo',
      sans-serif;
    ```

**確認ポイント**:
- クロスプラットフォームで一貫した表示になるか

---

### ✅ タスク12: URL Stateによる日付管理の検討

- [ ] **02_ARCHITECTURE.md** のセクション7.2を修正
  - URL Stateを追加
  - 修正案:
    ```markdown
    | 選択中の日付 | URL | searchParams |
    ```

- [ ] コード例を追加:
  ```typescript
  // app/page.tsx
  const searchParams = useSearchParams();
  const selectedDate = searchParams.get('date') || new Date().toISOString().split('T')[0];
  ```

**確認ポイント**:
- ブラウザバック/フォワードで日付移動できるか

---

### ✅ タスク13: テストカバレッジの根拠明確化

- [ ] **01_REQUIREMENTS.md** のNFR-10を修正（行174-179）
  - 修正案:
    ```markdown
    #### NFR-10: コード品質

    **テストカバレッジ目標**:
    - Domain層（ビジネスロジック）: 100%
    - Application層（Use Cases）: 90%以上
    - Infrastructure層: 80%以上
    - Presentation層（UI Components）: 60%以上
    - **全体平均**: 80%以上

    **根拠**:
    - Domain層はビジネスルールの中核のため完全なテストが必須
    - UI層は手動テストやVRTと併用するため低めに設定
    ```

**確認ポイント**:
- 各層のカバレッジ目標が明確か
- 根拠が説明されているか

---

## 📝 修正完了後の確認事項

- [ ] すべてのバージョン表記がメジャーバージョンのみになっているか
- [ ] 存在しないファイルへの参照がないか
- [ ] MVP版のアーキテクチャが一貫しているか（LocalStorage vs Server Actions）
- [ ] UI/UX設計が実装可能な内容か
- [ ] データモデルとコード例が一致しているか
- [ ] 矛盾・不整合が解消されているか

---

## 🎯 修正優先順位

**今すぐ修正（リリースブロッカー）**:
1. タスク1: バージョン表記
2. タスク2: 存在しないファイルへの参照
3. タスク3: MVP版アーキテクチャ
4. タスク5: Dial UI設計

**リリース前に修正**:
5. タスク4: 保存UX
6. タスク6: 認証の明確化
7. タスク8: 整合性チェック

**将来的に改善**:
8. タスク7, 9-13

---

**チェックリスト作成日**: 2026-02-08
